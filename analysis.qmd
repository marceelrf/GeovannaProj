---
title: "Geovanna - Analysis"
author: "Marcel Ferreira"
format: html
editor: visual
date: today
---

## About

```{r,echo=FALSE,message=FALSE}
library(tidyverse)
```

## Data

```{r}
data <- readxl::read_xlsx(path = "data/data_mrf.xlsx",sheet = 2)
head(data)
```

É necessário arrumar os dados seguindo as estas considerações:

```{r}
data_fix <- data %>% 
  mutate(across(ends_with("h"),
                \(x) str_remove(x,pattern = "\\<|\\>")
                )
         ) %>% 
  pivot_longer(cols = ends_with("h"),
               names_to = "Time",
               values_to = "Values") %>% 
  mutate(Values = as.numeric(Values),
         Time = factor(Time,
                       levels = c("0h","6h","12h","18h","24h")))
head(data_fix)
```

## Methods

-   Boostrap 1000x;

-   Principal component analysis (**PCA**);

## Results

### Boostrap

```{r}
library(boot)
```

### PCA

```{r}
PCA_mat <- data_fix %>% 
  tidyr::drop_na() %>% 
  mutate(code = glue::glue("{Trat}_{Time}_{N}")) %>% 
  #select(Trat,N,Time) %>% 
  pivot_wider(names_from = code, values_from = Values,id_cols = Citosina) %>% 
  column_to_rownames(var = "Citosina") %>% 
  mutate(across(everything(), ~replace_na(.x, 0))) %>% 
  as.matrix()

head(PCA_mat)
```

```{r}
PCA <- prcomp(PCA_mat,center = T,scale. = F)
```

```{r}
library(factoextra)
```

```{r}
fviz_pca_ind(PCA,geom = "point")
```
